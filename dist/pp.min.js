(function(g){var e={};var d=false;var f=false;var c=[];window.pp=function(i){if(pp.fn.isFunction(i)){d=true;g(function(){var k=function(){i.apply(window.pp);for(var l in window.pp){if(!window.pp.hasOwnProperty(l)){continue}if(l.toString().match(/^init/)){window.pp[l].call(pp)}}pp.activate(g(document))};if(!f){k.call()}else{c.push(k)}})}};pp.action=function(i){return new pp.ActionObject(i)};pp.ActionObject=function(k){var s=k;var r={};var i;var p=10;var l=5;var t;var o;var n;var q=this;var m=null;this.param=function(u,v){r[u]=v;return this};this.params=function(u){r=u;return this};this.timeout=function(u){p=u;return this};this.duration=function(u){l=u;return this};this.method=function(u){if(typeof(u)=="string"){m=u.toUpperCase()}return this};this.target=function(u){i=u;return this};this.before=function(u){t=u;return this};this.done=function(u){o=u;return this};this.error=function(u){n=u;return this};this.post=function(){if(typeof(t)=="function"){var u=t.call(pp,this);if(typeof(u)=="boolean"&&!u){return}}g.ajax({timeout:Math.ceil(p*1000),type:"POST",data:r,url:pp.url(s),dataType:"json",success:function(v){if(typeof(o)=="function"){o.call(pp,q,v)}},error:function(){if(typeof(n)=="function"){n.call(pp,q)}}})};this.get=function(){if(typeof(t)=="function"){var u=t.call(pp,this);if(typeof(u)=="boolean"&&!u){return}}g.ajax({timeout:Math.ceil(p*1000),type:"GET",data:r,url:pp.url(s),dataType:"json",success:function(v){if(typeof(o)=="function"){o.call(pp,q,v)}},error:function(){if(typeof(n)=="function"){n.call(pp,q)}}})};this.pull=function(){if(typeof(t)=="function"){var u=t.call(pp,this);if(typeof(u)=="boolean"&&!u){return}}if(!m){m=pp.action.GET}g.ajax({timeout:Math.ceil(p*1000),type:m,data:r,url:pp.url(s),dataType:"html",success:function(v){if(i){g(i).html(v);pp.activate(g(i))}if(typeof(o)=="function"){o.call(pp,q,v)}},error:function(){if(typeof(n)=="function"){n.call(pp,q)}}})};this.poll=function(){if(typeof(t)=="function"){var u=t.call(pp,this);if(typeof(u)=="boolean"&&!u){return}}if(!m){m=pp.action.GET}this.param("_",(new Date()).getTime());g.ajax({timeout:Math.ceil(p*1000),type:m,data:r,url:pp.url(s),dataType:"json",success:function(v){if(i){g(i).html(v)}if(typeof(o)=="function"){o.call(pp,q,v)}setTimeout(function(){q.poll()},Math.ceil(l*1000))},error:function(){if(typeof(n)=="function"){n.call(pp,q)}setTimeout(function(){q.poll()},Math.ceil(l*1000))}})};return this};pp.nil=Number.MAX_VALUE-100;pp.action.POST="post";pp.action.GET="get";pp.on=function(l,i){if(this==pp){if(!pp.fn.isArray(l)){l=[l]}var m=new pp.on(l,i);if(pp.fn.isFunction(i)){m.done(i)}l.asArray().each(function(q,p){e[p]=m});return m}var o;var n;var k;this.before=function(p){if(typeof(p)=="undefined"){return o}o=p;return this};this.done=function(p){if(typeof(p)=="undefined"){return n}n=p;return this};this.error=function(p){if(typeof(p)=="undefined"){return k}k=p;return this}};pp.url=function(l,m){var i=l.replace(/\./g,"/");if(i.length>0&&i.substring(0,1)!="/"){i="/"+i}else{i="/"}if(typeof(m)=="object"){var k=g.param(m);if(k.length>0){i+="?"+k}}return i};pp.go=function(i,k){window.location.href=pp.url(i,k)};pp.fn={};pp.fn.isFunction=function(i){return(typeof(i)=="function")};pp.fn.isUndefined=function(i){return(typeof(i)=="undefined")};pp.fn.isDefined=function(i){return !pp.fn.isUndefined(i)};pp.fn.isBoolean=function(i){return(typeof(i)=="boolean")};pp.fn.isYes=function(i){return(typeof(i)=="boolean"&&i)};pp.fn.isNo=function(i){return(typeof(i)=="boolean"&&!i)};pp.fn.isObject=function(i){return(typeof(i)=="object")};pp.fn.isArray=function(i){return(i instanceof Array)};pp.log=function(){if(!pp.config.log){return}if(pp.fn.isObject(console)&&pp.fn.isFunction(console.log)){var k=[];for(var l=0;l<arguments.length;l++){k.push(arguments[l])}return console.log.apply(console,k)}};pp.activate=function(i){i.find("*[pp-action]").each(function(){var l=g(this);var k=l[0].tagName.toUpperCase();if(k=="FORM"){l.submit(function(){var s=l.attr("pp-action");var r=null;if(typeof(e[s])!="undefined"){r=e[s];var t=r.before();if(pp.fn.isFunction(t)){var p=t.call(pp,l);if(pp.fn.isBoolean(p)&&!p){return false}}}var q=new FormData(l[0]);g.ajax({url:pp.url(s),data:q,type:"POST",dataType:"json",contentType:false,processData:false,success:function(u){if(r!=null){var v=r.done();if(pp.fn.isFunction(v)){v.call(pp,l,u)}}},error:function(){if(r!=null){var u=r.error();if(pp.fn.isFunction(u)){u.call(pp,l)}}}});return false});l.named=function(p){return this.find("*[name='"+p+"']")}}else{var m=l.attr("pp-action");if(typeof(e[m])!="undefined"){var n=e[m];var o=n.before();if(pp.fn.isFunction(o)){o.call(pp,l)}}l.click(function(){var q=l.attr("pp-action");if(typeof(e[q])!="undefined"){var r=e[q];var p=r.done();if(pp.fn.isFunction(p)){p.call(pp,l)}}return false})}l.param=function(p,q){if(pp.fn.isUndefined(q)){return g(this).attr("pp-data-"+p)}g(this).attr("pp-data-"+p,q);return q};l.action=function(){return g(this).attr("pp-action")}})};pp.batch=function(i){for(var k in window.pp){if(!window.pp.hasOwnProperty(k)||k=="batch"){continue}if(k.toString().match(new RegExp("^"+i))){window.pp[k].call(pp)}}};pp.Timer=function(m){var p=0;var o=1;var n=1;var i=1;var l;var k=this;if(!pp.fn.isFunction(m)){pp.log("Timer should input a function");return}this._runFn=function(){if(i==-1&&l){clearInterval(l);l=null;return}i--;m.call(this)};this.run=function(){i=n;if(i==1){l=setTimeout(function(){k._runFn()},p*1000)}else{if(i==0){return this}else{i--;if(i<0||i>0){l=setTimeout(function(){k._runFn();l=setInterval(function(){k._runFn()},o*1000)},p*1000)}}}return this};this.delay=function(q){p=q;return this};this.duration=function(q){o=q;return this};this.repeat=function(q){n=q;return this};this.infinite=function(){n=-1;return this};this.cancel=function(){if(l){clearTimeout(l);clearInterval(l);l=null}i=n;return this};this.pause=function(){if(l){clearTimeout(l);clearInterval(l);l=null}return this};this.resume=function(){if(l){return this}if(i!=0){l=setInterval(function(){k._runFn()},o*1000)}return this};return this};pp.Array=function(){pp.mixIn(this,pp.Iterator);var l=[];if(arguments.length==0){l=[]}else{if(arguments.length==1&&typeof(arguments[0])=="object"){for(var k=0;k<arguments[0].length;k++){l.push(arguments[0][k])}}else{for(var k=0;k<arguments.length;k++){l.push(arguments[k])}}}this.contains=function(n,i){var m=this.keys(n,i);return(m.length>0)};this.keys=function(p,m){var o=[];if(!pp.fn.isDefined(m)){m=false}for(var n=0;n<l.length;n++){if((m&&p===l[n])||(!m&&p==l[n])){o.push(n)}}return o};this.push=function(n){l.push(n);if(arguments.length>1){for(var m=1;m<arguments.length;m++){l.push(arguments[m])}}};this.pop=function(){return l.pop()};this.remove=function(m){m=parseInt(m,10);var o=new pp.Array();if(l.length>=m+1&&m>-1){for(var n=0;n<l.length;n++){if(n!=m){o.push(l[n])}}}else{o=this}l=o.values()};this.removeValue=function(o,p){var n=this.keys(o,p);for(var m=0;m<n.length;m++){this.remove(n[m])}};this.values=function(){return l};this.length=function(){return l.length};this.count=function(){return this.length()};this.get=function(i){if(i>this.length()){return null}return l[i]};this.set=function(i,m){l[i]=m};this.sort=function(i){if(!pp.fn.isDefined(i)){i=function(n,m){if(n>m){return 1}else{if(n==m){return 0}else{return -1}}}}l.sort(i)};this.rsort=function(i){this.sort(i);this.reverse()};this.asort=function(m){var n=new pp.Array();for(var o=0;o<l.length;o++){n.push(o)}if(!pp.fn.isDefined(m)){m=function(p,i){if(p<i){return -1}if(p>i){return 1}return 0}}for(var o=0;o<l.length;o++){for(j=0;j<l.length;j++){if(j>0&&m(l[j-1],l[j])>0){this.swap(j,j-1);n.swap(j,j-1)}}}return n};this.arsort=function(i){var m=this.asort(i);this.reverse();m.reverse();return m};this.reverse=function(){l=l.reverse();return this};this.swap=function(o,n){var m=this.get(o);var i=this.get(n);this.set(o,i);this.set(n,m)};this.clear=function(){l=[]};this.toString=function(){return l.toString()};this.unique=function(m){var o=new pp.Array();for(var n=0;n<l.length;n++){if(!o.contains(l[n],m)){o.push(l[n])}}return o};this.copy=function(){return new pp.Array(l)};this.max=function(i){if(this.length()>0){var m=this.copy();m.rsort(i);return m.get(0)}return null};this.min=function(i){if(this.length()>0){var m=this.copy();m.sort(i);return m.get(0)}return null};this.empty=function(){return(l.length==0)};this.concat=function(){for(var m=0;m<arguments.length;m++){if(arguments[m] instanceof Array){l=l.concat(arguments[m])}else{if(arguments[m] instanceof pp.Array){l=l.concat(arguments[m].values())}else{l=l.concat(arguments[m])}}}};this.join=function(i){return l.join(i)};this.shift=function(){return l.shift()};this.unshift=function(){for(var m=0;m<arguments.length;m++){l.unshift(arguments[m])}};this.slice=function(n,m){if(!pp.fn.isDefined(m)){m=l.length}if(m<0){m=0}var i=(n>0)?n+m:l.length;return(new pp.Array(l.slice(n,i)))};this.splice=function(m,i){return new pp.Array(l.splice.apply(l,arguments))};this.splice$=function(n,i){var m=this.copy();m.splice.apply(m.values(),arguments);return m};this.asMap=function(){return this};this.diff=function(m){var i=new pp.Array();this.each(function(o,n){if(!m.include(n)){i.push(n)}});return i};this.intersect=function(m){var i=new pp.Array();this.each(function(o,n){if(m.include(n)){i.push(n)}});return i}};Array.prototype.asArray=function(){return new pp.Array(this)};pp.range=function(o,k,m){var n=[];if(!pp.fn.isDefined(m)){m=1}if(o<k){for(var l=o;l<=k;l+=m){n.push(l)}}else{for(var l=o;l>=k;l-=m){n.push(l)}}return new pp.Array(n)};pp.Iterator={each:function(n){if(typeof(n)!="function"){throw new Error(this.toString()+" each: iterator is not a function.")}var q;if(pp.fn.isDefined(pp.Map)&&(this instanceof pp.Map)){q=this}else{if(this instanceof pp.Array){var i=this;for(var m=0;m<i.length();m++){var o=i.get(m);try{n.call(this,m,o)}catch(p){if(p instanceof pp.Iterator.Break){break}else{if(p instanceof pp.Iterator.Continue){continue}else{throw p}}}}return}else{q=this.asMap()}}var l=q.getContainer();for(var m in l){try{n.call(this,m,l[m])}catch(p){if(p instanceof pp.Iterator.Break){break}else{if(p instanceof pp.Iterator.Continue){continue}else{throw p}}}}},all:function(k){var i=true;this.each(function(m,l){if(!k(m,l)){i=false;h()}});return i},any:function(k){var i=false;this.each(function(m,l){if(k(m,l)){i=true;h()}});return i},collect:function(i){var k=new pp.Array();this.each(function(m,l){k.push(i(m,l))});return k},find:function(k){var i=null;this.each(function(m,l){if(k(m,l)){i=new pp.Entry(m,l);h()}});return i},entries:function(){var i=new pp.Array();this.each(function(m,l){i.push(new pp.Entry(m,l))});return i},findAll:function(k){var i=new pp.Array();this.each(function(m,l){if(k(m,l)){i.push(new pp.Entry(m,l))}});return i},reject:function(k){var i=new pp.Array();this.each(function(m,l){if(!k(m,l)){i.push(new pp.Entry(m,l))}});return i},include:function(k){var i=this.find(function(m,l){if(l==k){return true}});return(i==null)?false:true},grep:function(i){if(!(i instanceof RegExp)){i=new RegExp(i)}return this.findAll(function(m,l){return i.test(l.toString())})},inject:function(i,k){this.each(function(m,l){i=k(i,m,l)});return i}};pp.Iterator.Break=function(){};pp.Iterator.Continue=function(){};function b(){throw new pp.Iterator.Continue()}function h(){throw new pp.Iterator.Break()}pp.mixIn=function(i,l){for(var k in l){try{i[k]=l[k]}catch(m){throw new Error("pp.mixIn: get a error when set property: "+k)}}};var a=[].asArray();pp.require=function(){var k=new pp.Array();var i=[];new pp.Array(arguments).each(function(m,n){if(pp.fn.isFunction(n)){i.push(n);return}var l=n+".js";if(pp.fn.isDefined(pp.config.versions[n])){l+="?v="+pp.config.versions[n]}var o=pp.config.js+"/"+l;if(a.contains(o)||k.contains(o)){return}k.push(o)});if(k.length()==0){if(k.length()==0&&i.length>0){i.asArray().each(function(m,l){l.call()})}return}f=true;k.each(function(l,m){g.ajax({url:m,type:"get",dataType:"script",async:true,cache:true,success:function(){a.push(m);k.removeValue(m);if(k.length()==0){if(i.length>0){i.asArray().each(function(o,n){n.call()})}if(c.length>0){c.asArray().each(function(o,n){n.call()});c=[]}}}})})};pp.Entry=function(i,k){this.key=i;this.value=k};pp.config={js:"/js",log:true,versions:{}};if(!d){pp.activate(g(document))}window.pp=pp})(jQuery);